@page "/AddGasMeter"
@inherits FluxorComponent

<ExtendedPageTitle>Add Gas Meter</ExtendedPageTitle>

<MudGrid Justify="Justify.Center">
    <MudItem xs="12">
        <MudPaper Elevation="2" Class="p-2 mt-2">
            <MudTooltip ShowOnHover="true" Text="Return to Setup">
                <MudLink Underline="Underline.None"
                         Href="@($"/Setup")">
                    <MudButton Class="m-1" Color="Color.Primary"
                               ButtonType="ButtonType.Button"
                               Variant="Variant.Filled"
                               Size="Size.Small"
                               StartIcon="@Icons.Material.Filled.ArrowBack">Back to Setup</MudButton>
                </MudLink>
            </MudTooltip>
            <AddGasMeterFormComponent OnSuccessfulCallback="OnSuccessfulSave" />
        </MudPaper>
    </MudItem>
    @if (_showAuthorization)
    {
        <MudItem xs="12">
            <MudTooltip Text="Proceed to Authorize Meter for data access?">
                <MudLink Underline="Underline.None" Href="@($"/MeterAuthorization/{MeterType.Gas}")">
                    <MudButton Color="Color.Primary" ButtonType="ButtonType.Button" Variant="Variant.Filled" Size="Size.Small">Authorize</MudButton>
                </MudLink>
            </MudTooltip>
        </MudItem>
    }
</MudGrid>


@code
{
    bool _showAuthorization = false;

    private Task OnSuccessfulSave()
    {
        _showAuthorization = true;
        return Task.CompletedTask;
    }
}
