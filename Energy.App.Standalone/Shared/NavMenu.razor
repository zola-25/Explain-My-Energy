@using Energy.App.Standalone.Features.Setup.Store.ImmutatableStateObjects;
@inherits FluxorComponent
@inject IState<HouseholdState> HouseholdState
@inject IState<MeterSetupState> MeterSetupState


<MudPaper class="py-3" Elevation="0">
    <MudNavMenu Color="Color.Info" Bordered="true">
        <MudNavLink Href="/HouseholdSetup"  Class="menu-nav-item" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.House" ActiveClass="active-nav-item">
            Household Setup @if (HouseholdState.Value.Invalid || !HouseholdState.Value.Saved)
            {
                <MudIcon Color="Color.Warning" Icon="@Icons.Material.Filled.Settings"></MudIcon>
                <MudTooltip>Setup Required</MudTooltip>
            } else if (HouseholdState.Value.Saved)
            {
                <MudIcon Color="Color.Success" Icon="@Icons.Material.Filled.Check"></MudIcon>
            }

        </MudNavLink>
        
        <MudDivider></MudDivider>
        
        <MudNavLink Disabled="_electricityDisabled" Class="menu-nav-item" Href="/HeatingMeter/Electricity" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.ElectricBolt" ActiveClass="active-nav-item">
            <MeterNavLinkContent IsHeating="@(_heaterMeterType == MeterType.Electricity)">Electricity</MeterNavLinkContent>
        </MudNavLink>
        <MudNavLink Disabled="_gasDisabled" Class="menu-nav-item" Href="/HeatingMeter/Gas" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.LocalFireDepartment" ActiveClass="active-nav-item">
            <MeterNavLinkContent IsHeating="@(_heaterMeterType == MeterType.Gas)">Gas</MeterNavLinkContent>
        </MudNavLink>

    </MudNavMenu>
</MudPaper>

<style>
    
    .menu-nav-item a {
        text-decoration: none;
    }

    .active-nav-item {
        background-color: lightgrey
    }
</style>

@code {

    MeterType _heaterMeterType;


    bool _gasDisabled => !MeterSetupState.Value[MeterType.Gas].Authorized || !MeterSetupState.Value[MeterType.Gas].SetupValid;
    bool _electricityDisabled => !MeterSetupState.Value[MeterType.Electricity].Authorized || !MeterSetupState.Value[MeterType.Electricity].SetupValid;

    string _gasHref;
    string _electricityHref;


}
